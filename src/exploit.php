<?php
// Nom du fichier SQLite
$db_file = 'mails.db';

try {
    // Créer ou ouvrir la base de données SQLite
    $db = new SQLite3($db_file);

    // Créer la table "emails" si elle n'existe pas
    $db->exec('CREATE TABLE IF NOT EXISTS emails (mail TEXT)');

    // Si vous voulez insérer un email, vous pouvez le faire ici
    if ($_SERVER['REQUEST_METHOD'] === 'POST') {
        // Récupérer l'email à partir d'un formulaire
        $mail = $_POST['mail'];

        // Préparer la requête pour éviter les injections SQL
	$req = 'INSERT INTO emails (mail) VALUES ("'.$_POST["mail"].'")';
        $stmt = $db->prepare($req);

        // Exécuter la requête
        if ($stmt->execute()) {
            echo "Email enregistré avec succès.";
        } else {
            echo "Erreur lors de l'enregistrement de l'email.";
        }
    }

} catch (Exception $e) {
    // Gérer les erreurs de connexion à la base de données
    echo "Erreur : " . $e->getMessage();
}
?>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire Email</title>
</head>
<body>
    <h1>Formulaire Email</h1>
    <form action="" method="POST">
        <label for="mail">Entrez votre email :</label>
        <input type="email" id="mail" name="mail" required>
        <button type="submit">Envoyer</button>
    </form>
</body>
</html>
